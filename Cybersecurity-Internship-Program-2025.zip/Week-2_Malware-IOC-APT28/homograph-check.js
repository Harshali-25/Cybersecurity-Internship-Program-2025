// homograph-check.js
const punycode = require("punycode/");

function isSuspicious(url) {
  try {
    const u = new URL(url);
    const hostname = u.hostname;

    // Check if it uses punycode (IDN)
    if (hostname.includes("xn--")) {
      return true; // definitely suspicious
    }

    // Check for non-ASCII characters (e.g., Cyrillic, Greek)
    if (/[^\x00-\x7F]/.test(hostname)) {
      return true;
    }

    return false; // seems safe
  } catch (err) {
    return true; // invalid URL also suspicious
  }
}

// Demo
const testUrls = [
  "https://youtube.com",                // safe
  "https://yÐ¾utube.com",                // Cyrillic 'o' (fake)
  "https://xn--pple-43d.com",           // punycode (fake apple.com)
  "https://google.com"                  // safe
];

for (const url of testUrls) {
  console.log(url, "=> suspicious?", isSuspicious(url));
}
